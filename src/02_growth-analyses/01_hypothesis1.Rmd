---
title: "Hypothesis 1"
description: "The use of the term “diversity” and related terminology has increased in PubMed abstracts since 1990."
output: html_document
weight: 1
---

Over the past several years, social scientists have noted that the discourse of "diversity" is expanding in use across various social contexts ([Berrey 2015](https://www.youtube.com/watch?time_continue=96&v=AyZJdEfYUjw&feature=emb_logo)). In this project, we are interested in measuring how often diversity and its various metonyms are mentioned in biomedical research over the three decades (1990-2019). Our first working hypothesis is that: 

* The use of the term 'diversity' and its related terminology has increased in biomedical abstracts since 1990. 

To test Hypothesis 1, we concatenated sets of diversity-related terms into 11 categories (aging, ancestry, cultural, diversity, genetic, minority, population, race/ethnicity, sex/gender, sexuality, and social class) and then used natural language processing to quantify the (1) variation of raw term counts over time and (2) the proportion of publications that a set of terms are used in each year. For a full list of terms in each category, see Supplementary Table 1A at the end of this page. 

### Raw Growth in Biomedical Abstracts

The first two plots show how these sets of terms have changed in a sample of ~59,000 biomedical abstracts. 

```{r figure 1a, echo=FALSE}
general_pop_terms <- read_rds("~/git/diversity/data/text_results/h1_counts.rds")

figure_1A <- general_pop_terms %>% 
  # grouping by year and filter relevant population terms 
  group_by(year) %>% count(term, sort = TRUE) %>% ungroup() %>% 
  filter(term == "diversity" | term == "cultural" | term == "genetic" | term == "population" | 
           term == "sex/gender" | term == "sexuality" | term == "aging" | term == "minority" |
           term == "race/ethnicity" | term == "ancestry" | term == "socio-economic") %>% 
  # graphing terms over time 
  ggplot() + 
  geom_line(aes(y = n, x = year, colour = term), size = 1.3, stat="identity") + 
  theme_minimal() +
  labs(title = "        Figure 1A. Total Growth of Diversity-Related \n Terminology in PubMed/MEDLINE Abstracts (1990-2019)",
       color =  "Term") + 
  #scale_linetype_manual( values=linetype) +
  ylab("Term Count") +
  theme(axis.title.x = element_blank(), 
        #axis.title.y = element_blank(), 
        legend.position = "none",
        legend.title = element_text(size = 10, hjust = 0.5, face="bold"),
        plot.title = element_text(size=12, hjust = 0.5)) +
  scale_color_manual(labels=c("aging",  "ancestry", "cultural", "diversity","genetic", "minority",
                              "population","race/ethnicity","sex/gender","sexuality","socio-economic"),
                     values=c("#f2be00", "#000000",  "#61B329", "#3B9AB2", "#E86F00", "#d23ccc", 
                              "#1b7524", "#005BB7", "#CC0000", "#ff8396", "#800080")) +
  scale_x_continuous(limits = c(1990, 2020),
                     breaks = c(1990, 1995, 2000, 2005, 2010, 2015, 2020)); ggplotly()
```

Figure 1A shows the growth in the raw word frequencies of diversity-related terms from 1990-2017. This plot shows that the term diversity has consistently grown over time (from only 2 mentions in 1992 to 381 in 2017). This trend offers preliminary support for H1, but is only one small part of how diversity-related terms are channging in use. Overall, most of the terms in this graph have increased, but we see the most notable growth in terms related to sex/gender and aging research. While this growth is in part because scientists now have a larger dictionary of terms to describe sexed/gendered and aging populations, the focus on these topics is not simply a function of a more comprehensive vocabulary. Supplementary Table 1B provides the totals of top terms used in the aging, class, sex/gender, and sexualities categories, showing that, for example, the use of "women" would have the fifth highest total in the final year of this plot. Figure 1A also shows that terms like population, genetic, and cultural have also risen notably over time while terms associated with race/ethnicity, minority, class, sexuality, social class, and ancestry have all grown at a slower pace than the set of diversity terms.

### Proportional Growth in Biomedical Abstracts

To normalize for the growth of overall publications, we look at change in the proportion of available abstracts.

```{r figure 1b, echo=FALSE}
gen_pop_prc_counts <- read_rds("~/git/diversity/data/text_results/h1_percentages.rds")

# graphing terms over time 
figure_1B <- gen_pop_prc_counts %>% ggplot() + 
  geom_line(aes(y = prc_aging, x = year, colour = "aging"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_ancestry, x = year, colour = "ancestry"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_class, x = year, colour = "socio-economic"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_cultural, x = year, colour = "cultural"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_diversity, x = year, colour = "diversity"), size = 1.3, stat="identity", linetype = "solid") +
  #geom_line(aes(y = prc_ethnic, x = year, colour = "ethnic"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_genetic, x = year, colour = "genetic"), size = 1.3, stat="identity") +
  #geom_line(aes(y = prc_linguistic, x = year, colour = "linguistic"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_minority, x = year, colour = "minority"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_population, x = year, colour = "population"), size = 1.3, stat="identity") +
  #geom_line(aes(y = prc_racial, x = year, colour = "racial"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_racial, x = year, colour = "race/ethnicity"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_sexgender, x = year, colour = "sex/gender"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_sexuality, x = year, colour = "sexuality"), size = 1.3, stat="identity") +
  labs(title = "        Figure 1B. Proportional Growth Diversity-Related \n Terminology in PubMed/MEDLINE Abstracts (1990-2019)",
       color =  "Term") + 
  theme_minimal() +
  ylab("Proportion of Abstracts") +
  theme(axis.title.x = element_blank(), 
        #axis.title.y = element_blank(), 
        legend.position = "none",
        #legend.title = element_text(size = 10, hjust = 0.5, face="bold"),
        plot.title = element_text(size=12, hjust = 0.5)) +
  scale_color_manual(labels=c("aging",  "ancestry", "cultural", "diversity","genetic", "minority",
                              "population","race/ethnicity","sex/gender","sexuality","socio-economic"),
                     values=c("#f2be00", "#000000",  "#61B329", "#3B9AB2", "#E86F00", "#d23ccc", 
                              "#1b7524", "#005BB7", "#CC0000", "#ff8396", "#800080")) +
  scale_x_continuous(limits = c(1990, 2020),
                     breaks = c(1990, 1995, 2000, 2005, 2010, 2015, 2020)); ggplotly()
```

While the raw totals suggested that diversity-related terms are rising, the proportions outlined in Figure 1B suggest that the sets of diversity-related terms has changed relatively little over time. For example, the terms associated with aging, ancestry, minority, sex/gender, sexualities, social class, and race/gender have stayed relatively stable over time. Perhaps the most interesting trend is the sex/gender line, which rises from 8% to 12% of articles from 1990 to 1996 before returning to around ~8% in 2005. In contrast, the terms associated with population, genetic, class, and diversity have all steadily increased from their baseline in 1990. 

### Main Takeaways 

Overall, our results provide support for the notion that the use of the term "diversity" is increasing in the biomedical abstracts, but when taken on whole it seems that this growth is quite modest. The raw term frequencies suggest that diversity-related terminology has grown dramatically over time, but the proportional analyses temper these findings by showing that some trends, like sex/gender and race/ethnicity, have actually declined in recent years. Future work will need to examine what social, political and economic factors may have contributed to these declines. 

### Appendices 

Here is a list of the terms in each category analyzed above. You can scroll through each category or use the search tool to see if a term of interest was used in the analyses.

```{r biomedical_wordfreqs, echo = FALSE}
aging_terms <- general_pop_terms %>% 
  filter(di_aging == 1 & year == 2017) %>% 
  #group_by(year) %>% 
  count(word) %>% 
  arrange(-n) %>% 
  rename(aging_term = word, aging_n = n) %>% 
  rowid_to_column(var = "rowname") 
sexgender_terms <- general_pop_terms %>% 
  filter(di_sexgender == 1 & year == 2017) %>% 
  #group_by(year) %>% 
  count(word) %>% 
  arrange(-n) %>% 
  rename(sexgender_term = word, sexgender_n = n) %>% 
  rowid_to_column(var = "rowname") 
sexualities_terms <- general_pop_terms %>% 
  filter(di_sexuality == 1 & year == 2017) %>% 
  count(word) %>% 
  arrange(-n) %>% 
  rename(sexualities_term = word, sexualities_n = n) %>% 
  rowid_to_column(var = "rowname")  
class_terms <- general_pop_terms %>% 
  filter(di_class == 1 & year == 2017) %>% 
  count(word) %>% 
  arrange(-n) %>% 
  rename(class_term = word, class_n = n) %>% 
  rowid_to_column(var = "rowname")
joined_tables <- full_join(aging_terms, class_terms, by = "rowname")
joined_tables <- full_join(joined_tables, sexgender_terms, by = "rowname")
joined_tables <- full_join(joined_tables, sexualities_terms, by = "rowname") %>% select(-rowname)
joined_tables[is.na(joined_tables)] <- ""
datatable(joined_tables, 
          colnames = c('Aging', 'Total', 'Class', 'Total','Sex/Gender', 'Total', 'Sexualities', 'Total'),
          caption = 'Supplementary Table 1B: 2017 Totals for Aging, Class, Sex/Gender, and Sexualities Category (Biomedical Sample)', rownames = FALSE)
```

### Sensitivity Checks 

Should provide a few examples of false positive diversity results 
And examples of what "true positives" of diversity are 
Best case would be to provide a confusion matrix here and then go into detail with the false/true positive overview 


While most of our terms are specific to each category in which they are listed. However, the term "minority" is one term that we were concerned about producing false positive results. As a sensitivity check, we found that in the large majority of cases minority was being used alongside diversity, racial, sex/gender, or sexuality terms in our dataset. However, it should be noted that there remains a 2-9% false positive rate in any given year when the term minority does not clearly relate to diversity research. While we considered removing these instances from our dataset, we decided to maintain consistency across our datasets noting that there is likely some noise in almost all categories and altering one category is likely to create problems for accurate comparison across the categories in the plot. The abstracts listed in the following table are examples of the false-positives included in the minority category.

```{r h1_sensitivity_minority, echo=FALSE, eval=FALSE}
minority_abstracts <- general_pop_terms %>% 
  group_by(id) %>% 
  summarise(sum_minority = sum(di_minority), 
            sum_diversity = sum(di_diversity),
            sum_racial = sum(di_racial),
            sum_sexgender = sum(di_sexgender),
            sum_sexuality = sum(di_sexuality),) %>% 
  filter(sum_minority >= 1) %>% 
  inner_join(biomed_text_data, by = "id") %>% 
  mutate(abstract = tolower(abstract)) %>% 
  select(id, sum_minority, sum_diversity, sum_racial, sum_sexgender, sum_sexuality, abstract, year) %>% 
  filter(sum_diversity == 0 & sum_racial == 0 & sum_sexgender == 0 & sum_sexuality == 0) %>% 
  filter(!grepl("marginalized|minorities|under-represented|underrepresented|african-american|african|caucasian|white|asian|asian-american|native|hispanic|latino", 
                abstract))
minority_table <- minority_abstracts %>% select(year, abstract)
#sum(general_pop_terms$di_minority)
#sum(minority_abstracts$sum_minority)
#minority_abstracts %>% group_by(year) %>% count(year)
#write_csv(minority_abstracts, "minority_abstracts.csv")
datatable(minority_table, colnames = c('Year', 'Abstract'),
          caption = 'Supplementary Table 1C: Examples of False-Positive Uses of Minority in Biomedical Sample', options = list(pageLength = 5, dom = 'tip'), rownames = FALSE)
```

