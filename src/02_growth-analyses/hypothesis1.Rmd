---
title: "Hypothesis 1"
description: "The use of the term “diversity” and related terminology has increased in PubMed abstracts since 1990."
output: html_document
weight: 1
---

```{r, include=FALSE}
rm(list = ls())

library("tidyverse")
library("tidytext")
library("plotly")

h1_all_set_counts_full <- read_rds("~/git/diversity/data/text_results/h1_results/h1_all_set_counts_full.rds")
h1_all_set_counts_trends <- read_rds("~/git/diversity/data/text_results/h1_results/h1_all_set_counts_trends.rds")
general_pop_terms <- read_rds("~/git/diversity/data/text_results/h1_results/h1_all_set_prc_trends.rds")

```

Over the past several years, social scientists have noted that the discourse of "diversity" is expanding in use across various social contexts ([Berrey 2015](https://www.youtube.com/watch?time_continue=96&v=AyZJdEfYUjw&feature=emb_logo)). In this project, we are interested in measuring how often diversity and its various metonyms are mentioned in biomedical research over the three decades (1990-2019). Our first working hypothesis is that: 

* The use of the term 'diversity' and its related terminology has increased in biomedical abstracts since 1990. 

To test Hypothesis 1, we concatenated sets of diversity-related terms into 11 categories (aging, ancestry, cultural, diversity, genetic, minority, population, race/ethnicity, sex/gender, sexuality, and social class) and then used natural language processing to quantify the (1) variation of raw term counts over time and (2) the proportion of publications that a set of terms are used in each year. For a full list of terms in each category, see Supplementary Table 1A at the end of this page. 

### Raw Growth in Biomedical Abstracts

The first two plots show how these sets of terms have changed in a sample of ~59,000 biomedical abstracts. 

```{r figure 1a, echo=FALSE}
`%notin%` <- Negate(`%in%`)

figure_1A <- general_pop_terms %>% 
  # recode terms 
  select(-starts_with("prc_")) %>% 
  pivot_longer(!year, names_to = "term", values_to = "n") %>%
  mutate(term = str_replace(term, "cnt_", ""),
         term = str_replace(term, "sexgender", "sex/gender"),
         term = str_replace(term, "racial", "race/ethnicity"),
         term = str_replace(term, "\\b(?i)(diversity)\\b", "diversity (all)"),
         term = str_replace(term, "class", "socio-economic"),
         term = str_replace(term, "soc_diversity", "diversity (social)")) %>% 
  # graphing terms over time 
  filter(term %notin% c("total", "ancestry", "population", "genetic")) %>% 
  ggplot() + 
  geom_line(aes(y = n, x = year, colour = term), size = 1.3, stat="identity") + 
  theme_minimal() +
  labs(title = "        Figure 1A. Total Growth of Diversity-Related \n Terminology in PubMed/MEDLINE Abstracts (1990-2020)",
       color =  "Term") + 
  #scale_linetype_manual( values=linetype) +
  ylab("Term Count") +
  theme(axis.title.x = element_blank(), 
        #axis.title.y = element_blank(), 
        legend.position = "none",
        legend.title = element_text(size = 10, hjust = 0.5, face="bold"),
        plot.title = element_text(size=12, hjust = 0.5)) +
  scale_color_manual(labels=c("aging", "cultural","diversity (all)","diversity (social)", 
                              "minority","race/ethnicity","sex/gender", "sexuality","socio-economic"),
                     values=c("#E86F00", # orange 
                              "#61B329", # light green
                              "#f2be00", # mustard
                              "#9a009a", # purple
                              "#000000", # dark green 
                              "#005BB7", # dark blue 
                              "#CC0000", # red 
                              "#ff8396", # pinkish 
                              "#3B9AB2" # light blue  
                              #"#000000", # black
                              #"#d23ccc", # pink 
                              # 1b7524 dark green
                              )) + 
  #scale_y_log10() +
  scale_x_continuous(limits = c(1990, 2020),
                     breaks = c(1990, 1995, 2000, 2005, 2010, 2015, 2020)); ggplotly()
```

Figure 1A shows the growth in the raw word frequencies of diversity-related terms from 1990-2017. This plot shows that the term diversity has consistently grown over time (from only 2 mentions in 1992 to 381 in 2017). This trend offers preliminary support for H1, but is only one small part of how diversity-related terms are channging in use. Overall, most of the terms in this graph have increased, but we see the most notable growth in terms related to sex/gender and aging research. While this growth is in part because scientists now have a larger dictionary of terms to describe sexed/gendered and aging populations, the focus on these topics is not simply a function of a more comprehensive vocabulary. Supplementary Table 1B provides the totals of top terms used in the aging, class, sex/gender, and sexualities categories, showing that, for example, the use of "women" would have the fifth highest total in the final year of this plot. Figure 1A also shows that terms like population, genetic, and cultural have also risen notably over time while terms associated with race/ethnicity, minority, class, sexuality, social class, and ancestry have all grown at a slower pace than the set of diversity terms.

### Proportional Growth in Biomedical Abstracts

To normalize for the growth of overall publications, we look at change in the proportion of available abstracts.

```{r figure 1b, echo=FALSE}
# graphing terms over time 
figure_1B <- general_pop_terms %>% 
  select(-starts_with("cnt_")) %>% 
  ggplot() + 
  geom_line(aes(y = prc_aging, x = year, colour = "aging"), size = 1.3, stat="identity") +
  #geom_line(aes(y = prc_ancestry, x = year, colour = "ancestry"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_class, x = year, colour = "socio-economic"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_cultural, x = year, colour = "cultural"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_diversity, x = year, colour = "diversity (all)"), size = 1.3, stat="identity", linetype = "solid") +
  geom_line(aes(y = prc_soc_diversity, x = year, colour = "diversity (social)"), size = 1.3, stat="identity", linetype = "solid") +
  #geom_line(aes(y = prc_genetic, x = year, colour = "genetic"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_minority, x = year, colour = "minority"), size = 1.3, stat="identity") +
  #geom_line(aes(y = prc_population, x = year, colour = "population"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_racial, x = year, colour = "race/ethnicity"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_sexgender, x = year, colour = "sex/gender"), size = 1.3, stat="identity") +
  geom_line(aes(y = prc_sexuality, x = year, colour = "sexuality"), size = 1.3, stat="identity") +
  labs(title = "        Figure 1B. Proportional Growth Diversity-Related \n Terminology in PubMed/MEDLINE Abstracts (1990-2020)", color =  "Term") + 
  theme_minimal() +
  ylab("Proportion of Abstracts") +
  theme(axis.title.x = element_blank(), 
        legend.position = "none",
        plot.title = element_text(size=12, hjust = 0.5)) +
  scale_color_manual(labels=c("aging", "cultural",  "diversity (all)", "diversity (social)", 
                              "minority",  "race/ethnicity",  "sex/gender", "sexuality",  "socio-economic"),
                     values=c("#E86F00", # orange 
                              "#61B329", # light green
                              "#f2be00", # mustard
                              "#9a009a", # purple
                              "#000000", # dark green 
                              "#005BB7", # dark blue 
                              "#CC0000", # red 
                              "#ff8396", # pinkish 
                              "#3B9AB2" # light blue  
                              #"#000000", # black
                              #"#d23ccc", # pink 
                              # 1b7524 dark green
                              )) + 
  #scale_y_log10() +
  scale_x_continuous(limits = c(1990, 2020),
                     breaks = c(1990, 1995, 2000, 2005, 2010, 2015, 2020)); ggplotly()
```

While the raw totals suggested that diversity-related terms are rising, the proportions outlined in Figure 1B suggest that the sets of diversity-related terms has changed relatively little over time. For example, the terms associated with aging, ancestry, minority, sex/gender, sexualities, social class, and race/gender have stayed relatively stable over time. Perhaps the most interesting trend is the sex/gender line, which rises from 8% to 12% of articles from 1990 to 1996 before returning to around ~8% in 2005. In contrast, the terms associated with population, genetic, class, and diversity have all steadily increased from their baseline in 1990. 

### Main Takeaways 

Overall, our results provide support for the notion that the use of the term "diversity" is increasing in the biomedical abstracts, but when taken on whole it seems that this growth is quite modest. The raw term frequencies suggest that diversity-related terminology has grown dramatically over time, but the proportional analyses temper these findings by showing that some trends, like sex/gender and race/ethnicity, have actually declined in recent years. Future work will need to examine what social, political and economic factors may have contributed to these declines. 

### Appendices 

Here is a list of the terms in each category analyzed above. You can scroll through each category or use the search tool to see if a term of interest was used in the analyses.

```{r, echo = FALSE}
setwd("~/git/diversity/data/dictionaries/")
divictionary <- read_csv("diversity_project - h1_dictionary.csv")
first_table <- divictionary %>% select(aging, sex_gender, sexuality, social_class)
first_table[is.na(first_table)] <- ""
datatable(first_table, caption = 'Supplementary Table 1A: Term Sets Used for Hypothesis 1 Testing', rownames = FALSE)
```
```{r, echo = FALSE}
second_table <- divictionary %>% select(cultural, diversity, minority, race_ethnicity)
second_table[is.na(second_table)] <- ""
datatable(second_table, rownames = FALSE)
```

```{r biomedical_wordfreqs, echo = FALSE}
subset_counts <- read_rds("~/git/diversity/data/text_results/h1_results/h1_all_subset_counts_full.rds") %>% 
  filter(!term %in% c("genetic", "population", "ancestry")) %>% 
  rename(`term set` = term, `words in term set` = word) %>% select(`term set`, `words in term set`, count)
datatable(subset_counts, caption = 'Supplementary Table 1B: Frequency of Words Used in Each Term Set (1990-2020)', rownames = FALSE)
```


